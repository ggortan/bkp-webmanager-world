<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # RewriteBase deve corresponder ao caminho onde a aplicação está instalada
    # Exemplo: /world/bkpmng/ se a aplicação estiver em https://domain.com/world/bkpmng/
    RewriteBase /world/bkpmng/
    
    # Se o arquivo existir na pasta public, serve diretamente
    RewriteCond %{REQUEST_URI} !^/world/bkpmng/public/
    RewriteCond %{DOCUMENT_ROOT}/world/bkpmng/public%{REQUEST_URI} -f
    RewriteRule ^(.*)$ public/$1 [L]
    
    # Se for um arquivo ou diretório real na raiz, deixa passar
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Redireciona tudo para public/index.php
    RewriteRule ^(.*)$ public/index.php [QSA,L]
</IfModule>

# Bloqueie acesso direto a arquivos sensíveis
<FilesMatch "\.(env|log|sql|md|sh)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Bloqueie acesso a arquivos ocultos (exceto .htaccess)
<FilesMatch "^\.(?!htaccess)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Bloqueia acesso direto a pastas sensíveis
<IfModule mod_rewrite.c>
    RewriteRule ^(app|config|database|logs|routes)/ - [F,L]
</IfModule>

# Disable directory listing
Options -Indexes
